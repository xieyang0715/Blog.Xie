---
title: 获取系统版本号
date: 2020-12-03 01:47:54
tags: 日常挖掘
toc: true
---





今天写shell时, 需要根据系统版本来区别进行不同的配置, 发现sh, bash有不同的输出。

```bash
root@ubuntu-template:~/php# yum

Command 'yum' not found, but can be installed with:

apt install yum

root@ubuntu-template:~/php# sh -c 'which yum &>/dev/null; echo $?'
0
root@ubuntu-template:~/php# bash -c 'which yum &>/dev/null; echo $?'
1
root@ubuntu-template:~/php# 
```

也就是，仅仅通过apt/yum命令来区别, 需要解释器是bash才有正常的结果。



# 1. python获取版本

想到ansible就内置了获取系统版本的变量`ansible_facts['os_family'] == "Debian"`, 获取ansible python源码, 得到一种获取版本的方法

```bash
python -c 'import platform; os,version,_ = platform.dist(); print(os.lower())'
```

# 2. os-release文件获取

# 3. 脚本中使用

```bash
python -c 'import platform; os,version,_ = platform.dist(); print(os.lower())'

source /etc/os-release
case $ID in
    centos|fedora|rhel)
    	;;
    debian|ubuntu|devuan)
    	;;
    *)
    	exit 1
    	;;
esac
```

