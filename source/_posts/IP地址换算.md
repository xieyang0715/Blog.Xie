---
title: IP地址换算
date: 2021-02-08 06:20:53
tags: 生产小经验
---



今天配置kubernetes的`service-cluster-ip`时指定的网络是`10.76.0.0/12`，在启动kube-apiserver时，一直自动定位到`10.64.0.1`, 因为这个地址在签发`kube-apiserver`证书会将ip地址添加至请求文件中，所以需要知道一个网络的第一个ip。



https://blog.csdn.net/fanren224/article/details/73485344



求子网掩码或短格式

> 给了子网掩码，255.240.0.0，转换二进制格式，从左至右数有多少个1，就是短格式。

> 给了短格式的12，即 0000 0000 . 0000 0000 . 0000 0000 . 0000 0000 ， 这个前12位为1，即是1111 1111 . 1111 0000 . 0000 0000 . 0000 0000 , 就是255.240.0.0



网络地址 = IP(二进制) & 掩码(二进制)

>16.158.165.91/22
>
>16.158. 占16位
>
>后6位对应165，即1010 0101二进制占前6位
>
>1010 01 是网络位
>
>01 是主机位、
>
>网络地址就是网络位不变，主机位为0
>
>16.158.<1010 01><00>.0
>
>16.158.41.0/22 网络地址
>
>广播地址就是主机位为1，
>
>16.158.<1010 01><11>.255
>
>16.158.167.255
>
>网络内主机数：2 ^(主机位数) -2(全0全1)



/22 不是 8 的整数倍，不好办，只能先变成二进制来看。16.158 的部分不会动，它占了前 16 位。中间的 165，变为二进制为‭10100101‬。除了前面的 16 位，还剩 6 位。所以，这 8 位中前 6 位是网络号，16.158.<101001>，而 <01>.91 是机器号。

第一个地址是 16.158.<101001><00>.1，即 16.158.164.1。子网掩码是 255.255.<111111><00>.0，即 255.255.252.0。广播地址为 16.158.<101001><11>.255，即 16.158.167.255。



基于网络划分子网 

10.76.0.0/12 网络是 10.64.0.0/12

```bash
10.<0100 1100>.0.0 = 10.76.0.0/12
10.<1111 0000>.0.0
10.<0100 0000>.0.0 = 10.64.0.0/12
```

从8位10.0.0.0/12向后借4位才是12位，所以有2^4=16个子网。网络有

```bash
10.<0000 0000>.0.0 0     0
10.<0001 0000>.0.0 1     16
10.<0010 0000>.0.0 2     32
10.<0011 0000>.0.0 3     64
10.<0100 0000>.0.0 4
10.<0101 0000>.0.0 5
10.<0110 0000>.0.0 6
10.<0111 0000>.0.0 7
10.<1000 0000>.0.0 8
10.<1001 0000>.0.0 9
10.<1010 0000>.0.0 10
10.<1011 0000>.0.0 11
10.<1100 0000>.0.0 12
10.<1101 0000>.0.0 13
10.<1110 0000>.0.0 14
10.<1111 0000>.0.0 15
```

从8位10.0.0.0/13向后借5位才是13位，所以有2^5=32个子网。网络有

```bash
10.<0000 0000>.0.0 0     0
10.<0000 1000>.0.0 0     8
10.<0001 0000>.0.0 0     16
```

