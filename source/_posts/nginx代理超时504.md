---
title: nginx代理超时504
date: 2021-08-26 11:05:01
tags:
- 生产小经验
- nginx
---



# 前言

504 代理网关获取后端响应超时

默认是60s, 60s内后端必须处理完数据，响应给代理



当后端db连接池满了，新的连接需要操作db时，就需要等待db连接池的超时，默认60s, 如果60s没有连接获取到就会报超时。说明其他连接60s都不释放。

但是nginx的超时是60s，后端超时不到就kill了连接，响应504。

要么调整nginx超时，调大为65s。

<!--more-->
要么调整db连接超时，调小为55s。
