---
title: 1. 学习计划
date: 2020-09-22 17:11:39
tags: plan
toc: true
---



# 1. 学习进度 

今年从9月21预计学习到下年1月21，学完架构篇

# 2. 阶段性目标 

https://docs.qq.com/sheet/DWXduSlZLVldTTkpr?tab=BB08J2

<!--more-->

| 日期      | 星期   | 计划       | 努力小时数 | 总结 |
| --------- | ------ | ---------- | ---------- | ---- |
| 2020/9/21 | 星期一 | 完成第一天 | 2          |      |
| 2020/9/22 | 星期二 | 完成第一天 | 1          |      |
| 2020/9/23 | 星期三 | 完成第一天 | 1          |      |
| 2020/9/24 | 星期四 | 完成第一天 |            |      |
| 2020/9/25 | 星期五 | 完成第一天 |            |      |
| 2020/9/26 | 星期六 |            |            |      |
| 2020/9/27 | 星期日 |            |            |      |
| 2020/9/28 | 星期一 | 完成第二天 | 0          |      |
| 2020/9/29 | 星期二 | 完成第二天 | 0          |      |
| 2020/9/30 | 星期三 | 完成第二天 | 0          |      |
| 2020/10/1 | 星期四 | 完成第二天 | 0          |      |
| 2020/10/2 | 星期五 | 完成第二天 | 0          |      |
| 2020/10/3 | 星期六 |            | 0          |      |
| 2020/10/4 | 星期日 |            | 0          |      |

- 小阶段, 小总结
- 长时间坚持

# 3. 学习笔记

为了方便后期查阅

## 3.1 形成文档

## 3.2 简化笔记

为了厘清课程框架



# 4. 学习方法

## 4.1  杰哥 

- 阶段性目标
- 从无到有，从弱到强，从小白到大牛。马哥在2015年，还不知道K8S是谁，都是慢慢学
- 先了解、后熟练、后精通。08年开始学习。杰哥，已经12年了
  - 上来不了解底层，先不管实现。听不懂，只需要知道有这个功能。
  - 做不出来，就在努力。
- 一万小时定律

> 《异类》 书中指出
> 		天才并非卓越，而是付出了持续不断的努力。
> 		每天8小时，一周5天，至少3年。

短时间学不会，就坚持

- 《终生成长》
  - 新技术层出不穷
  - 终生成长：任何人在任何阶段，都需要学习
- 运维：先广度、再深度
  - 开发：只需要会一个方向
  - 面试一定要说出方面中级和高级的东西

## 4.2 马哥 

一条条去实现

KPI

价值观：团队、共享、自驱能力

技术很快会过时。1年留存50%, 2年25%

## 4.3 simon

![image-20200927103205436](http://myapp.img.mykernel.cn/image-20200927103205436.png)



##  4.4 大师兄

![image-20200927103147705](http://myapp.img.mykernel.cn/image-20200927103147705.png)


#  5.  学习路径

服务分层, 不同层不同网段,   不同网段可以划分权限

##  5.1  防火墙

tcp转发,  非常多的公网ip，交给cdn, web安全防护, 不考虑考虑安全。

抗高并发，图片识别，违法评论 

一段时间内连接数达5000，封IP

## 5.2 4层  负载层, VIP内网地址, 172.16-31/10

keepalived生成vip，   “高可用”

处理请求：lvs/haproxy

###   5.2.1 lvs：常用dr模式

需要所有节点有公网的VIP，不通用

场景：有固定公网IP，访问量大。

###  5.2.2 haproxy, 性能略低lvs

场景：k8s,  openstack

一个haproxy上百个vip, 一个物理机200-300个vip

tcp转发 , http动静分离





##  5.3  7层 负载，动静分离

- 作用：判断用户请求静态资源(js,css,图片)代理至静态服务器。动态资源(登陆)到tomcat. (静态也到tomcat效率低)
  - 静态分离：图片位置需要共享存储(nas:戴尔、华为、联想)挂载至图片目录, index.html还得打包至容器。

###  5.3.1 nginx
###  5.3.2 tengine,  taobao基于nginx二次开发
###  5.3.2 apache



并发：1个nginx，10万



## 5.4 后端服务器，动态层

修改、上传数据

80%  java

80%*80%:  tomcat

并发：1个tomcat, 500并发



## 5.5 存储层

作用：动态层操作数据库

主从、读写分离、双 主



##  5.6  缓存

登陆在这个tomcat登陆, 而这个登陆信息其他的tomcat不知道。如果LB为RR或没有做 hash绑定, 一刷新，或一点别的页面。他可能跳到别的服务器上，别的服务器不知道你登陆过，就会让你重新登陆。

###  5.6.1 redis, 主流

### 5.6.2 memcached



##  5.7 监控

没有工作经验, 刚接触运维, zabbix一定要学好。给你未来做一个监控工程师打下一个良好的基础。

因为你上班之后，你一般是先看监控。虽然这个工作不重要。但是比较耗时，有可能值班。

不会zabbix, 试用期随时可能被裁。不违反法律。
你也可以随时走，你可以给公司说一下：试用期没过，我不合适，我不干了。他们没有办法去拦你了。



#### 5.7.1  zabbix  

#### 5.7.2  第三方

zabbix在机房, 你想实现采集全国各地访问你的网站耗时。

#####  5.7.2.1 免费 ，功能不多 

站长之家 -> 站长工具 -> 网站测试 -> www.magedu.com	

##### 5.7.2.2 付费，监控宝、听云

结合商业监控结合zabbix,  全国各地访问网站的性能

#### 5.7.3  prometheus  +  grafana

zabbix监控主机。k8s容器监控,zabbix不适合这个场景。

在代码更新后，容器ip会变, zabbix配置会变



prometheus收集数据, grafana通过PQL查询数据来展示

###  5.8 消息队列

给业务层使用

在微服务器架构，业务间异步调用。

####  5.8.1 异步调用

1. 通过IP地址调用，不能横向扩容, 扩容后的新IP不知道。(etcd的service就可以了，一个固定的端点。)
2. 发消息至队列。另一个服务只需要监听队列，只要有消息就处理。

#### 5.8.2 rabbitmq 自带集群

#### 5.8.3 kafka + zookeeper

#### 5.8.4 其他实现

rabbitmq



### 5.9 服务扩容

虚拟机：创建虚拟机、初始化。太慢了。
微服务：功能拆分，比如有单点登陆的功能，开发时不做单点登陆的功能，想登陆就调用单点登陆。想连什么组件，就调用什么组件。大大节省开发包的体积。
体积越小，部署起来就越快，BUG越少。

微服务：
问题：怎么调用？怎么发现？
自动注册：dubbo

容器编排：
docker，基于镜像创建微服务
横向扩容、代码升级：kubernetes + docker



### 5.10 代码发布

gitlab + jenkins

持续集成 + 持续部署

###  5.11 日志收集
访问慢，慢在哪？
#### 5.11.1 不看日志 ，靠猜。
可能这里慢，负载高，数据库慢了，带宽有问题，可能交换机有问题。
####  5.11.2 看服务日志
在各种服务日志里面会告诉你哪个地方太慢了，哪个地方耗时多长。

#### 5.11.3 ELK

elasticsearch + logstash + kibana

收集宿主机：物理服务器、虚拟机。

应用级别：nginx、apache、tomcat, 主要在k8s环境, 
使用容器之后，不允许开发进入，开发进入容器, 万一操作什么东西，那这个容器改了，别的容器没有改。就会导致环境不一致。或数据不一致，用户访问时就会出现一些差异。

开发需要看报错啊，把容器的日志，也吞到ELK。
限制开发和测试对生产服务权限

1. 解决开发看日志。
2. 保证环境稳定性。
3. 最多给一个sudo主要看java服务器的性能



### 5.12  阿里云 中小公司，7-8服务器

刚成立时，不会将服务器托管在什么地方。





# 6. 课程框架

## 6.1  中级运维工程师

低于15K

LB: haproxy
WEB: nginx
监控 zabbix, openfalcon(redis、mysql、grafana)
大公司安排很细。
开始yum源
1年后管lvs
缓存: redis
持续集成 + 持续部署 
消息队列: kafka, rabbitmq
日志收集: elasticsearch  logstash kibana filebeat/fluentd redis
公有云: aliyun

## 6.2 高级运维工程师

找个15K左右。发挥好的话，20K也可以

私有云 openstack
微服务 dubbo + zookeeper
组件名称、画出图来、出问题看日志就知道。
业务有多少服务、服务间怎么调用。

容器技术：Docker
容器编排工具：kubernetes



# 7. 关于马哥教育
> 博客：mageedu.blog.51cto.com
> 主页：www.magedu.com
> qq: 1661815153 113228115



